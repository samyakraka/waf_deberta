version: "3.8"

services:
  # DVWA - Damn Vulnerable Web Application
  dvwa:
    image: vulnerables/web-dvwa
    container_name: waf-dvwa
    ports:
      - "8081:80"
    networks:
      - waf-network
    restart: unless-stopped

  # OWASP Juice Shop
  juiceshop:
    image: bkimminich/juice-shop
    container_name: waf-juiceshop
    ports:
      - "3000:3000"
    networks:
      - waf-network
    restart: unless-stopped

  # WebGoat
  webgoat:
    image: webgoat/webgoat:latest
    container_name: waf-webgoat
    ports:
      - "8082:8080"
    networks:
      - waf-network
    restart: unless-stopped

  # Nginx Reverse Proxy for Log Collection
  nginx:
    image: nginx:alpine
    container_name: waf-nginx
    ports:
      - "80:80"
      - "8080:8080"
      - "8090:8090"
      - "8091:8091"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ../nginx/logs:/var/log/nginx
    depends_on:
      - dvwa
      - juiceshop
      - webgoat
    networks:
      - waf-network
    restart: unless-stopped

networks:
  waf-network:
    driver: bridge
